<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="708px" preserveAspectRatio="none" style="width:766px;height:708px;background:#FFFFFF;" version="1.1" viewBox="0 0 766 708" width="766px" zoomAndPan="magnify"><title>CILogon Authentication &amp; REMS Authorization Oni Implementation</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="479.8486" x="144.8735" y="28.5352">CILogon Authentication &amp; REMS Authorization Oni Implementation</text><g><title>Oni-UI</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="512.7891" width="8" x="33.2148" y="116.8867"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37" x2="37" y1="116.8867" y2="629.6758"/></g><g><title>Oni</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="512.7891" width="8" x="198.5166" y="116.8867"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="202.3379" x2="202.3379" y1="116.8867" y2="629.6758"/></g><g><title>Oni DB</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="512.7891" width="8" x="425.7461" y="116.8867"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="428.8018" x2="428.8018" y1="116.8867" y2="629.6758"/></g><g><title>REMS</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="512.7891" width="8" x="537.314" y="116.8867"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="540.6904" x2="540.6904" y1="116.8867" y2="629.6758"/></g><g><title>CILogon</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="512.7891" width="8" x="688.7666" y="116.8867"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="691.9375" x2="691.9375" y1="116.8867" y2="629.6758"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="58.4297" x="5" y="113.0898">Oni-UI</text><ellipse cx="37.2148" cy="79.6875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="25.2148" x2="49.2148" y1="93.6875" y2="93.6875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="58.4297" x="5" y="646.0781">Oni-UI</text><ellipse cx="37.2148" cy="665.875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="25.2148" x2="49.2148" y1="679.875" y2="679.875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.3574" x="184.3379" y="113.0898">Oni</text><ellipse cx="202.5166" cy="79.6875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="190.5166" x2="214.5166" y1="93.6875" y2="93.6875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="30.3574" x="184.3379" y="646.0781">Oni</text><ellipse cx="202.5166" cy="665.875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="190.5166" x2="214.5166" y1="679.875" y2="679.875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="59.8887" x="396.8018" y="113.0898">Oni DB</text><ellipse cx="429.7461" cy="79.6875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="417.7461" x2="441.7461" y1="93.6875" y2="93.6875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="59.8887" x="396.8018" y="646.0781">Oni DB</text><ellipse cx="429.7461" cy="665.875" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="417.7461" x2="441.7461" y1="679.875" y2="679.875"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="46.3359" x="515.146" y="91.8906">REMS</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="131.2471" x="472.6904" y="113.0898">(Authorization)</text><ellipse cx="541.314" cy="58.4883" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="529.314" x2="553.314" y1="72.4883" y2="72.4883"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="46.3359" x="515.146" y="646.0781">REMS</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="131.2471" x="472.6904" y="667.2773">(Authorization)</text><ellipse cx="541.314" cy="687.0742" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="529.314" x2="553.314" y1="701.0742" y2="701.0742"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="71.7451" x="653.894" y="91.8906">CILogon</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="139.6582" x="619.9375" y="113.0898">(Authentication)</text><ellipse cx="692.7666" cy="58.4883" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="680.7666" x2="704.7666" y1="72.4883" y2="72.4883"/></g><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="71.7451" x="653.894" y="646.0781">CILogon</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="139.6582" x="619.9375" y="667.2773">(Authentication)</text><ellipse cx="692.7666" cy="687.0742" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="680.7666" x2="704.7666" y1="701.0742" y2="701.0742"/></g><g><polygon fill="#181818" points="190.5166,150.0859,200.5166,154.0859,190.5166,158.0859,194.5166,154.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="37.2148" x2="196.5166" y1="154.0859" y2="154.0859"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="66.7441" x="44.2148" y="148.2891">"/login"</text></g><g><polygon fill="#181818" points="680.7666,185.2852,690.7666,189.2852,680.7666,193.2852,684.7666,189.2852" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.5166" x2="686.7666" y1="189.2852" y2="189.2852"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="235.7402" x="209.5166" y="183.4883">"/api/oauth/cilogon/login"</text></g><g><polygon fill="#181818" points="213.5166,220.4844,203.5166,224.4844,213.5166,228.4844,209.5166,224.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.5166" x2="691.7666" y1="224.4844" y2="224.4844"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="233.5166" x="219.5166" y="218.6875">"/api/oauth/cilogon/code"</text></g><g><polygon fill="#181818" points="417.7461,255.6836,427.7461,259.6836,417.7461,263.6836,421.7461,259.6836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.5166" x2="423.7461" y1="259.6836" y2="259.6836"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="174.3311" x="209.5166" y="253.8867">"create or find user"</text></g><g><polygon fill="#181818" points="213.5166,290.8828,203.5166,294.8828,213.5166,298.8828,209.5166,294.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.5166" x2="428.7461" y1="294.8828" y2="294.8828"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="159.249" x="219.5166" y="289.0859">"found or created"</text></g><g><polygon fill="#181818" points="48.2148,326.082,38.2148,330.082,48.2148,334.082,44.2148,330.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="42.2148" x2="201.5166" y1="330.082" y2="330.082"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="133.6377" x="54.2148" y="324.2852">"session token"</text></g><g><polygon fill="#181818" points="190.5166,361.2813,200.5166,365.2813,190.5166,369.2813,194.5166,365.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="37.2148" x2="196.5166" y1="365.2813" y2="365.2813"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="141.3018" x="44.2148" y="359.4844">"/memberships"</text></g><g><polygon fill="#181818" points="529.314,396.4805,539.314,400.4805,529.314,404.4805,533.314,400.4805" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.5166" x2="535.314" y1="400.4805" y2="400.4805"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="287.2002" x="209.5166" y="394.6836">"&lt;REMS&gt;//entitlements?user=X"</text></g><g><polygon fill="#181818" points="213.5166,431.6797,203.5166,435.6797,213.5166,439.6797,209.5166,435.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.5166" x2="540.314" y1="435.6797" y2="435.6797"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="122.458" x="219.5166" y="429.8828">"entitlements"</text></g><g><polygon fill="#181818" points="417.7461,466.8789,427.7461,470.8789,417.7461,474.8789,421.7461,470.8789" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.5166" x2="423.7461" y1="470.8789" y2="470.8789"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="188.6836" x="209.5166" y="465.082">"update entitlements"</text></g><g><polygon fill="#181818" points="190.5166,502.0781,200.5166,506.0781,190.5166,510.0781,194.5166,506.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="37.2148" x2="196.5166" y1="506.0781" y2="506.0781"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="108.3955" x="44.2148" y="500.2813">"/object/:id"</text></g><g><polygon fill="#181818" points="417.7461,537.2773,427.7461,541.2773,417.7461,545.2773,421.7461,541.2773" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.5166" x2="423.7461" y1="541.2773" y2="541.2773"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="203.2295" x="209.5166" y="535.4805">"authorize middleware"</text></g><g><polygon fill="#181818" points="213.5166,572.4766,203.5166,576.4766,213.5166,580.4766,209.5166,576.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.5166" x2="428.7461" y1="576.4766" y2="576.4766"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="107.7627" x="219.5166" y="570.6797">"authorized"</text></g><g><polygon fill="#181818" points="48.2148,607.6758,38.2148,611.6758,48.2148,615.6758,44.2148,611.6758" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="42.2148" x2="201.5166" y1="611.6758" y2="611.6758"/><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="107.7627" x="54.2148" y="605.8789">"authorized"</text></g><!--SRC=[PP5FJyCm3CNl-HHM3WWEKyKDJJ0q_acJG4XCI1ouP8stcQL9bQH2xDCJfrtNhRtvlPzVRIVioDRAgmeqhbLZuekpSKbxXEiR8I95WrDuNBowZRCmR-8MRQHIHKhb1NmylospwZpjM_7T4Yogsc2Lo2m9Reb_q7uo0PFFXSo52j04z0E2RTawpjB1O1MU7cGdwvKOjl0Kt_RoP8uhsULxhC8GxdRf-ECsVKDf1Cy4and_2gOW2-CsPANWCgcboQAggN0gPHGb6OuyOCaVz8wnqcdim_8s39OULKHm7jPaTJvBXf9xJ5kx9dc9QMdTn-I94n0m17w5w7QOHZbVfC9gXJvigGvzAn-8pLi-uwmeygtQvmlt773t9KM6Za53PhnAKsjUvHGQpU9MFrZ6OafwdA2wfqIeI6k3lyhZ-1ezTNg7CqVy0m00]--></g></svg>